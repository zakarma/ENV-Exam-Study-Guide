<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Environmental Science Quiz Tracker</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 20px;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }
        
        .stat {
            text-align: center;
            flex: 1;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .not-learned { color: #dc3545; }
        .still-learning { color: #ffc107; }
        .mastered { color: #28a745; }
        
        .question-container {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }
        
        .question-number {
            color: #667eea;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .question-text {
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 20px;
        }
        
        .options {
            list-style: none;
            padding: 0;
        }
        
        .option {
            background: white;
            margin: 10px 0;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #e9ecef;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .option:hover {
            border-color: #667eea;
            transform: translateX(5px);
        }
        
        .option.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .option.correct {
            background: #28a745;
            color: white;
            border-color: #28a745;
        }
        
        .option.incorrect {
            background: #dc3545;
            color: white;
            border-color: #dc3545;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            flex: 1;
        }
        
        .btn-submit {
            background: #667eea;
            color: white;
        }
        
        .btn-next {
            background: #28a745;
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .progress-bar {
            background: #e9ecef;
            height: 10px;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745 0%, #20c997 100%);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .hidden {
            display: none;
        }
        
        .result-message {
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: bold;
        }
        
        .result-correct {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .result-incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .round-indicator {
            background: #667eea;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            margin-top: 10px;
            display: inline-block;
        }
        
        .review-mode {
            background: #ffc107 !important;
            color: #212529 !important;
        }
        
        .completion-message {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border-radius: 15px;
            margin-top: 20px;
        }
        
        .final-stats {
            background: rgba(255,255,255,0.2);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Environmental Science Quiz Tracker</h1>
            <p>Quizlet-Style Learning System</p>
            <div id="roundIndicator" class="round-indicator">Round 1 - Initial Learning</div>
        </div>
        
        <div class="stats">
            <div class="stat">
                <div class="stat-number not-learned" id="notLearnedCount">0</div>
                <div>Not Learned</div>
            </div>
            <div class="stat">
                <div class="stat-number still-learning" id="stillLearningCount">0</div>
                <div>Still Learning</div>
            </div>
            <div class="stat">
                <div class="stat-number mastered" id="masteredCount">0</div>
                <div>Mastered</div>
            </div>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <div id="questionContainer" class="question-container">
            <div class="question-number" id="questionNumber">Question 1 of 77</div>
            <div class="question-text" id="questionText"></div>
            <ul class="options" id="optionsList"></ul>
            
            <div id="resultMessage" class="result-message hidden"></div>
            
            <div class="controls">
                <button class="btn btn-submit" id="submitBtn" onclick="submitAnswer()">
                    Submit Answer
                </button>
                <button class="btn btn-next hidden" id="nextBtn" onclick="nextQuestion()">
                    Next Question →
                </button>
            </div>
        </div>
        
        <div id="completionMessage" class="completion-message hidden">
            <h2>🎉 Quiz Complete!</h2>
            <div class="final-stats">
                <h3>Final Results:</h3>
                <p><span class="mastered">Mastered:</span> <span id="finalMastered">0</span> questions</p>
                <p><span class="still-learning">Still Learning:</span> <span id="finalStillLearning">0</span> questions</p>
                <p><span class="not-learned">Not Learned:</span> <span id="finalNotLearned">0</span> questions</p>
                <p><strong>Overall Score: <span id="finalPercentage">0</span>%</strong></p>
            </div>
            <button class="btn" onclick="resetQuiz()" style="background: white; color: #28a745; margin-top: 15px;">
                Start Over
            </button>
        </div>
    </div>

    <script>
        const questions = [
            {
                text: "When an exponentially growing population multiplies so fast that it exceeds its carrying capacity and begins to degrade its environment the result will be:",
                options: ["Overshoot and a population crash", "Course correction", "Population stabilization", "A renewable resource"],
                correct: 0
            },
            {
                text: "Human populations are rapidly urbanizing and now more than 50% of all people live in cities. This:",
                options: ["is unequivocally good for the environment", "is unequivocally bad for the environment", "can have both positive and negative impacts on the environment"],
                correct: 2
            },
            {
                text: "Some scientists from Whoville conducted an environmental impact statement on a proposed industrial plant and found that there was a 50% chance that the plant would irrevocably pollute the drinking water for all residents of Whoville. The science is uncertain, however, and there is a 50% chance that the plant will cause no harm. Under these circumstances, the precautionary principle tells us that:",
                options: [
                    "we should pause before granting approval for the plant, to allow time for more assessments, rather than potentially causing a catastrophe.",
                    "because there is a chance of harm, the industrial plant should never be constructed, and there is no need to further study the issue.",
                    "we should continue with construction of the plant, because there is a 50% chance that there will be no harm at all, and we should only close the plant if we find evidence that the drinking water is contaminated.",
                    "the precautionary principle is not relevant here, because it only applies to scientifically settled scenarios."
                ],
                correct: 0
            },
            {
                text: "Improved sanitation, an increased food supply and control of disease spreading organisms has resulted in which of the following effects on human population?",
                options: ["Increased death rate", "Increased birth rate", "Accelerated population growth rate", "Decelerated population growth rate"],
                correct: 2
            },
            {
                text: "Human population growth rate underwent its greatest increase during which period of history?",
                options: ["Pre-agricultural times", "Pre-industrial times", "The Roman Empire", "The late 20th Century"],
                correct: 3
            },
            {
                text: "The carrying capacity of an environment represents?",
                options: ["The transition between juvenile and adult populations", "The maximum number of a particular species that an environment can support", "The replacement number of adults in a population", "The minimum number of a particular species that an environment can support"],
                correct: 1
            },
            {
                text: "The human population growth currently is labeled as a logistic growth curve. This type of growth curve is characterized as:",
                options: ["a flat line that shows high population growth to low population growth", "a descending line that depicts a reduction in population growth", "an ascending straight line that depicts a constant level of population growth", "an S-shaped curve that shows rapid growth"],
                correct: 3
            },
            {
                text: "The human population of the United States has increased over the last few hundred years due to all of the following reasons except:",
                options: ["improvements in health care", "improvements in agriculture", "the death rate has decreased", "the age of first childbirth has increased"],
                correct: 3
            },
            {
                text: "Which of the following is the correct sequence of steps, from beginning to end, in the Scientific Method:",
                options: ["Observations - hypothesis - controlled experiment - conclusions", "Conclusions - observations - alter observations to fit conclusions - future research and awards", "Hypothesis - controlled experiment - inferences - conclusions", "Conclusions - controlled experiment - observations - hypothesis"],
                correct: 0
            },
            {
                text: "Based on her knowledge of the theory of gravity a teacher walks into her science classroom and tells the students that if someone drops a ball off the roof of the building, it will fall to the ground. This is an example of:",
                options: ["deductive reasoning", "speculation", "manipulative reasoning", "inductive reasoning"],
                correct: 0
            },
            {
                text: "The manipulated variable is also called the:",
                options: ["observational variable", "independent variable", "dependent variable", "exciting variable"],
                correct: 1
            },
            {
                text: "An example of quantitative data is:",
                options: ["sight", "smell", "taste", "mass (in grams)"],
                correct: 3
            },
            {
                text: "A scientific hypothesis:",
                options: ["can never be the true answer to a scientific question", "is similar to a theory because it is based on numerous experiments", "can never become a scientific fact", "is really just an educated guess at the answer to a question"],
                correct: 3
            },
            {
                text: "Like the scientific method, decision making using scientific data is:",
                options: ["Best guesses", "Dictatorial", "A process of steps", "Unilateral"],
                correct: 2
            },
            {
                text: "Measurements allow scientists to:",
                options: ["Make predictions", "Disprove a statement", "Visualize relationships", "All of the above"],
                correct: 3
            },
            {
                text: "Measurements without an estimate of uncertainty are:",
                options: ["Correct", "Scientific", "Accurate", "Useless"],
                correct: 3
            },
            {
                text: "Pseudoscience is:",
                options: ["Untestable", "All of the above", "Lacks empirical evidence", "Based on faulty reasoning"],
                correct: 1
            },
            {
                text: "Dr. Smith is stressed about waking up and making it on time to the airport in order to catch his plane. He sets the alarm on his digital watch (reads to 1/100 of a second) and arrives at 7:00:00.00am. Unfortunately, every other clock in the airport terminal reads about 7:20am. Dr. smith is unable to make it through security in time and missed his flight. Which of the following is a correct statement about Dr. Smith's watch?",
                options: ["it is a lost timepiece", "it is accurate, but not precise", "it is neither accurate nor precise", "it is precise, but not accurate"],
                correct: 3
            },
            {
                text: "Which statement is TRUE:",
                options: ["Oxygen gas comprises 80% of the Earth's (dry) atmosphere", "Liquid water forms the basis of all life forms on Earth", "3.5 billion years ago oxygen was found in high concentrations on earth"],
                correct: 1
            },
            {
                text: "Which of the following set Earth apart from other planets in the solar system?",
                options: ["Earth is the only planet that has liquid water", "Earth is the only planet that has water at its triple point (gas, liquid, and solid phases at the same time)", "Earth is the only planet that exhibits plate tectonics", "Earth is the only planet that exhibits life", "a, b, c, and d are correct"],
                correct: 4
            },
            {
                text: "What is an example of negative feedback?",
                options: ["when its too cold and you shiver", "Warmer temperatures will lead to increased water vapor in the atmosphere (higher humidity)", "Colder temperatures leading to growth of the polar ice caps", "exponential growth"],
                correct: 0
            },
            {
                text: "Nitrogen has a very high concentration in the atmosphere and is cycled very slowly into and out of the atmosphere. Water vapor has a lower concentration in the atmosphere and is cycled quite rapidly. What statement is true:",
                options: ["Nitrogen has a lower residence time in the atmosphere than water vapor", "Nitrogen and water vapor have roughly the same residence time in the atmosphere", "Nitrogen has a higher residence time in the atmosphere than water vapor"],
                correct: 2
            },
            {
                text: "What term defines the steady state that all natural systems move towards without influence of people:",
                options: ["Ecological dynamics", "Stable equilibrium", "Dynamic equilibrium"],
                correct: 2
            },
            {
                text: "In this picture, what is the example of kinetic energy? (The picture shows the light from the sun, a lion feeding on its prey, and a zebra running at full speed.)",
                options: ["sun's rays", "lion's food", "running zebra"],
                correct: 2
            },
            {
                text: "Which of the following is not a greenhouse gas?",
                options: ["Methane", "Carbon dioxide", "Water Vapor", "Nitrogen"],
                correct: 3
            },
            {
                text: "Which of the following statements is true:",
                options: ["Both Tallahassee and Alberta Canada receive more solar radiation during the northern hemisphere summer than winter, but the difference between summer and winter incoming radiation is greater in Tallahassee than in Alberta.", "Both Tallahassee and Alberta Canada receive more solar radiation during the northern hemisphere summer than winter, but the difference between summer and winter incoming radiation is greater in Alberta than in Tallahassee", "Alberta Canada receives more solar radiation during the northern hemisphere summer than winter, while Tallahassee receives more solar radiation during the northern hemisphere winter than northern hemisphere summer.", "Tallahassee receives more solar radiation during the northern hemisphere summer than winter, while Alberta Canada receives more solar radiation during the northern hemisphere winter than northern hemisphere summer."],
                correct: 1
            },
            {
                text: "Storms are caused when:",
                options: ["Warm air rises and cools, causing the water vapor inside to condense, form clouds, and then eventually fall as rain.", "Coriolis causes wind to swirl leading to strong winds fueled by the rotating Earth.", "Coriolis cyclones mediate a moist condensation long-wave energy transfer.", "Cold air sinks, bringing rain with it."],
                correct: 0
            },
            {
                text: "The Gulf Stream:",
                options: ["redistributes wind energy around the globe", "transports warm water from equatorial regions towards the north pole", "transports cold water from equatorial regions towards the north pole", "is a tributary of the Mississippi River"],
                correct: 1
            },
            {
                text: "Soil Organic Carbon is recycled back to the atmosphere by:",
                options: ["Decomposers", "Bacteria", "Heterotrophic respiration", "all of the above"],
                correct: 3
            },
            {
                text: "This element generally forms 4 covalent bonds with other elements:",
                options: ["Carbon", "Nitrogen", "Oxygen", "Hydrogen"],
                correct: 0
            },
            {
                text: "Soil organic matter formation is a transfer directly from the biosphere to the:",
                options: ["Atmosphere", "Hydrosphere", "Lithosphere"],
                correct: 2
            },
            {
                text: "Which of the equations below is the correct one for NEP (net ecosystem production)?",
                options: ["GPP (which is gross CO2 uptake by plants)", "GPP - Autotrophic Respiration", "GPP - autotrophic respiration - soil (heterotrophic) respiration"],
                correct: 2
            },
            {
                text: "The life form that formed first on the early earth was:",
                options: ["Eukaryotes", "Prokaryotes", "Algae", "Mastodons", "Mushrooms"],
                correct: 1
            },
            {
                text: "The photic zone (sunlit zone) of the ocean extends to a depth of 3000 meters.",
                options: ["True", "False"],
                correct: 1
            },
            {
                text: "Ocean acidification due to higher Carbon dioxide concentrations in the atmosphere makes the pH of the ocean lower and this inhibits or reduces this process:",
                options: ["Denitrification (formation of N2gas from nitrate)", "Calcification (formation of shells and coral skeleton)", "Upwelling (the surfacing of deep nutrient-rich water)", "The global conveyor belt (thermohaline circulation)", "Respiration of organic matter in the deep sea"],
                correct: 1
            },
            {
                text: "An excess of nutrients in a body of water like a lake will lead to:",
                options: ["Eutrophication", "Oligotrification", "Electrification", "Remineralization"],
                correct: 0
            },
            {
                text: "This compound ion (NH4+) is:",
                options: ["Carbonic acid", "An amino acid", "Ammonium", "Nitrate", "Oxygen"],
                correct: 2
            },
            {
                text: "Two elements that are considered \"nutrient elements\" for plants growth in the ocean and on land are:",
                options: ["Nitrogen and chloride", "Nitrogen and Phosphorous", "Phosphorus and Sodium"],
                correct: 1
            },
            {
                text: "Earth is unique. What process maintain the earth as a habitable planet?",
                options: ["Temperatures that permit liquid water", "Our atmosphere cannot block ultraviolet radiation from space", "non existent oxygen levels"],
                correct: 0
            },
            {
                text: "What is an example of positive feedback?",
                options: ["exponential growth", "when it is too hot and you sweat", "when its too cold and you shiver"],
                correct: 0
            },
            {
                text: "The Coriolis effect:",
                options: ["Causes the wind to turn to the left in the northern hemisphere.", "Is caused by the rotation of the Earth.", "Explains how hot air balloons work.", "Causes the seasons."],
                correct: 1
            },
            {
                text: "Hurricanes are sustained by:",
                options: ["The latent heat released when water vapor in warm moist air condenses into water droplets.", "The Coriolis effect, which releases vast amounts of energy.", "Cold ocean water, beneath hot air, and the thermal inversion this can create.", "A series of negative feedbacks that cause the hurricane to grow stronger and stronger."],
                correct: 0
            },
            {
                text: "If everything else remained the same, but the surface ocean becomes warmer should we expect:",
                options: ["Hurricane intensity to increase and frequency to decrease", "Hurricane intensity and frequency to both increase", "Hurricane intensity and frequency to both decrease", "Hurricane intensity to decrease and frequency to increase"],
                correct: 1
            },
            {
                text: "In 1911 this person proposed that the continents had once been together and that they had drifted apart:",
                options: ["Charles Humbolt", "Charles Darwin", "Alfred Wegener", "Albert Einstein", "John Haber"],
                correct: 2
            },
            {
                text: "This equation below represents what process: CO2 + H2O → CH2O + O2",
                options: ["Autotrophic respiration", "Heterotrophic respiration", "Photosynthesis", "Primary production"],
                correct: 2
            },
            {
                text: "The Redfield ratio, or the ratio of C:N:P in marine, microbial, and animal tissue is:",
                options: ["250:125:48", "4:2:1", "106:16:1"],
                correct: 2
            },
            {
                text: "What part of the ocean is considered net heterotrophic:",
                options: ["the coastal ocean", "the photic zone above 500 meters", "the deep dark zone below 500 meters"],
                correct: 2
            },
            {
                text: "What is an endemic species?",
                options: ["a generalist species", "species found globally", "a species that is unique to a defined geographic location (e.g. it's not found elsewhere)", "a specialist species"],
                correct: 2
            },
            {
                text: "Which statement is FALSE?",
                options: ["The farther away from a continent the fewer the species", "islands tend to have more species than continents", "Islands tend to maintain consistent number of species over time", "The smaller the island the fewer the species"],
                correct: 1
            },
            {
                text: "Which of the following is incorrectly paired?",
                options: ["species dominance: the most aggressive species", "species evenness: the relative abundance of species", "species richness: the total number of species", "habitat diversity: the different kinds of habitats in a given unit area", "genetic diversity: the total number of genetic characteristics"],
                correct: 0
            },
            {
                text: "The major force(s) causing the genetic divergence of two populations is/are:",
                options: ["mutation and natural selection", "natural selection and the variety of other species with which each population interbreeds", "the complete lack of sexual reproduction in the two populations", "reproduction"],
                correct: 0
            },
            {
                text: "Which statement is correct?",
                options: ["Convergent evolution is when organisms have similar features but they don't have a common ancestor", "Divergent evolution is when organisms have similar features but they don't have a common ancestor", "Convergent evolution occurs when May look and act differently but they are still related", "Divergent evolution occurs when May look and act the same but they are not related"],
                correct: 0
            },
            {
                text: "Which of these does an ecosystem include:",
                options: ["1) The primary producers in a food web", "2) The consumers in a food web", "3) The decomposers in a food web", "4) The abiotic (non-living) component of the environment", "1, 2, 3, and 4", "1, 2, and 4 only", "1, 2, and 3 only", "1 and 4 only"],
                correct: 4
            },
            {
                text: "Which organism in this food chain of a hot spring ecosystem in Yellowstone National Park is the autotroph? Algae ⟹ herbivorous flies ⟹ killdeer birds ⟹ grey wolves ⟹ decomposing bacteria",
                options: ["Grey wolves", "Decomposing bacteria", "Killdeer birds", "Algae", "Herbivorous flies"],
                correct: 3
            },
            {
                text: "Ecosystems require:",
                options: ["a) At least one species that is a primary producer (autotroph)", "b) At least one species that is an herbivore", "c) At least one species that is a carnivore", "d) At least one species that is a decomposer", "e) A fluid medium for element and energy transfer", "f) all of the above", "g) a, b, and c", "h) a, d, and e"],
                correct: 7
            },
            {
                text: "Which factors affect the spread of a parasite?",
                options: ["1) Host abundance", "2) Host accessibility and ecosystem diversity", "3) Transmission rate of parasites", "4) Length of life of an infected host", "3 and 4", "1 and 2", "1, 2, 3, and 4", "1, 3, and 4"],
                correct: 6
            },
            {
                text: "What is the term used to explain the concept that the biological and geological forces shaping dune formation are the same today that they were in the geological past?",
                options: ["Competition", "Succession", "Gaia Hypothesis", "Uniformitarianism"],
                correct: 3
            },
            {
                text: "Zooxanthellae are:",
                options: ["Symbiotic algae that live inside hermatypic corals", "Responsible for primary production in coral reef ecosystems", "Part of a mutualistic symbiosis", "All of the above"],
                correct: 3
            },
            {
                text: "The marine pelagic environment differs from typical terrestrial (land) environments because it is:",
                options: ["dilute", "fluid", "three-dimensional", "all of the above"],
                correct: 3
            },
            {
                text: "Crown of thorns starfish feed directly on corals. What is this an example of?",
                options: ["Mutualism", "Commensalism", "Parasitism", "Predator-prey relationship"],
                correct: 3
            },
            {
                text: "Overgrowth is a strategy in which a coral grows up and then outwards, casting a shadow on other corals. This an example of what?",
                options: ["Exploitation Competition", "Interference Competition", "Commensalism", "Succession"],
                correct: 0
            },
            {
                text: "Tuna larvae can switch between feeding on different prey types. This will:",
                options: ["decrease diversity in the ocean", "be best thought of as a commensalistic symbiosis", "drive the evolution of vectors", "dampen potential predator-prey population cycles"],
                correct: 3
            },
            {
                text: "The surface ocean is very nutrient poor. Phytoplankton (also called algae) are thus under intense pressure to maximize their ability to take up nutrients as efficiently as possible. This is an example of:",
                options: ["Exploitation competition", "Interference competition", "Predator-prey relationships", "A mutualistic symbiosis"],
                correct: 0
            },
            {
                text: "The open-ocean is often nutrient limited and hence dominated by the phytoplankton (algae) species that are best adapted to taking up nutrients from the seawater. Often it is the taxa Prochlorococcus that dominates. However, when a strong storm comes through it will mix deep, nutrient-rich water up to the surface. In response to this disturbance, other phytoplankton will grow. Often diatoms are the first to respond and will have a bloom that lasts for a couple of weeks. As they start to deplete the available nutrients, another group of phytoplankton such as dinoflagellates or coccolithophores will take over. Once the nutrients have been completely exhausted, Prochlorococcus will again take over the ecosystem. This is an example of:",
                options: ["Secondary succession", "Parasitism", "Mutualistic symbioses", "Predator-prey relationships"],
                correct: 0
            },
            {
                text: "Consider two ocean food chains: 1) Diatoms ⟹ copepods ⟹ sardines 2) Cyanobacteria ⟹ nanoflagellates ⟹ ciliates ⟹ copepods ⟹ sardines. Which statement is true about these food chains?",
                options: ["The average trophic level of sardines is 4 in both food chains", "In food chain 1 the sardines have a higher trophic level than in food chain 2", "The sardines are at similar trophic levels in both food chains", "Food chain 1 will transfer a higher proportion of primary production to sardines than food chain 2"],
                correct: 3
            },
            {
                text: "What do you NOT need to consider when designing a protected area:",
                options: ["the size and spacing between protected areas", "species within the area to be protected", "threats within the area to be protected", "the weather at areas to be protected"],
                correct: 3
            },
            {
                text: "What is restoration?",
                options: ["The process of assisting the recovery of an ecosystem that has been degraded, damaged or destroyed", "captive breeding of a species", "introduction of invasive species", "monitoring the hydrology of a system"],
                correct: 0
            },
            {
                text: "How can climate change impact species?",
                options: ["Modify their abundance", "Change the timing of migratory and breeding cycles", "Alter their distribution in latitude and elevation", "All other options"],
                correct: 3
            },
            {
                text: "Which statement is FALSE in relation to designing protected areas:",
                options: ["Big is better than small", "Connected is better than unconnected", "Near is better than far", "Buffers are not needed"],
                correct: 3
            },
            {
                text: "Which of the following is a threat to biodiversity?",
                options: ["Habitat loss", "Overharvesting", "All options", "Climate Change"],
                correct: 2
            },
            {
                text: "Which statement is true about weather and climate:",
                options: ["Weather refers to meteorological conditions at a given place on a given day", "Climate refers to long-term averages, patterns, or trends in the weather", "Weather can be predicted for only a couple weeks, while climate can be predicted far into the future", "All of the above"],
                correct: 3
            },
            {
                text: "The satellite remote sensing record of earth's temperature extends:",
                options: ["approximately 150 years into the past", "back to the Cretaceous period", "40-50 years into the past", "back to the little Ice Age"],
                correct: 2
            },
            {
                text: "Recent research indicates that the variation in solar output:",
                options: ["is the major factor driving temperature change", "is greater than all the anthropogenic factors affecting climate change", "is more than 20 watts/m2", "is less than any of the anthropogenic factors affecting climate change", "will increase by a hundredfold over the next century"],
                correct: 3
            },
            {
                text: "Which statement is true about radiative forcing?",
                options: ["Radiative forcing is defined as the change in net downward radiative flux at the top of the atmosphere", "Radiative forcing is proportional to temperature change, although the constant of proportionality depends on feedbacks in the climate system", "Radiative forcing is measured in units of watts per meter squared", "All of the above"],
                correct: 3
            },
            {
                text: "Increased methane in the atmosphere will lead to a warming climate. If the climate warms the permafrost can thaw, releasing more methane into the atmosphere. This is an example of a _______ feedback:",
                options: ["negative", "positive", "compensatory"],
                correct: 1
            },
            {
                text: "Two types of plate boundaries are:",
                options: ["A. Divergent, as occur along mid ocean ridge", "B. Convergent, as in trenches and subduction zones", "C. Ocean basin", "D. Gulf of Mexico", "E. Both A and B"],
                correct: 4
            },
            {
                text: "Many scientists consider carbon dioxide the most important greenhouse gas because:",
                options: ["A) It is the most potent greenhouse gas", "B) It is the most abundant greenhouse gas in the atmosphere", "C) It is being produced by fossil fuel burning at a higher rate than other prominent greenhouse gases", "D) It has an incredibly long life-time in the atmosphere", "A & C", "C & D"],
                correct: 5
            },
            {
                text: "Which of the following is a positive feedback on climate change?",
                options: ["Increased cloud cover in tropical regions", "Increased water vapor (a greenhouse gas) in the atmosphere", "Melting glaciers will allow primary succession and lead to plants removing carbon dioxide from the atmosphere", "Stronger hurricanes will cause more damage in coastal communities"],
                correct: 1
            },
            {
                text: "The concept of black-body radiation tells us that:",
                options: ["Warmer bodies in the solar system will emit electromagnetic radiation with longer wavelengths than colder bodies", "A changing albedo will alter the earth's energy budget", "The amount of radiation given off by any body in the universe is determined by its temperature", "There is more energy entering the earth than leaving it"],
                correct: 2
            },
            {
                text: "When do individuals usually have a uniform distribution?",
                options: ["When resources are plentiful", "when resources are clumped", "When they compete for space", "When there is too many species in the system"],
                correct: 2
            },
            {
                text: "The form of Nitrogen that is unavailable to plants is:",
                options: ["Nitrate", "Ammonia", "Nitrogen gas", "Ammonium"],
                correct: 2
            },
            {
                text: "This compound ion (NO3-) is:",
                options: ["Ammonia", "An amino acid", "Ammonium", "Nitrate", "Oxygen"],
                correct: 3
            },
            {
                text: "This chemical reaction describes which of the processes below: CO2 + H2O → CH2O + O2",
                options: ["Aerobic Respiration", "Shell Formation", "Photosynthesis", "Ocean acidification"],
                correct: 2
            },
            {
                text: "What is true of typical early pioneer species:",
                options: ["They are usually closely related to climax species", "They are typically small and help to stabilize the environment", "Their roots usually destabilize the soil, leading to increased erosion", "They are common in primary succession but do not exist in secondary succession"],
                correct: 1
            },
            {
                text: "Zooxanthellae live inside hermatypic corals and supply the corals with sugar and other organic molecules, while the corals provide the zooxanthellae with protection and an ideal growth environment. What is this relationship an example of?",
                options: ["Parasitism", "Commensalism", "Predator-prey relationships", "Mutualism", "Succession"],
                correct: 3
            },
            {
                text: "Which of the following are indirect methods of estimating global temperature changes:",
                options: ["1) The Mg/Ca ratio of foraminifera in marine sediments", "2) Buoys in the ocean", "3) Thermometers on land", "4) Isotopic changes in ice cores", "5) Tree rings", "1, 3, and 5", "1, 4, and 5", "1, 3, 4, and 5", "All of the above"],
                correct: 6
            },
            {
                text: "What pieces of the historical record can be used to piece together climates from the 1100s – 1500s?",
                options: ["A) Records of extreme droughts", "B) Descriptions of frozen river events", "C) Thermometer measurements of ocean temperature", "D) Records of crop yields", "A, B, and C", "A, and C", "A, B, and D"],
                correct: 6
            },
            {
                text: "Which of the following is a climate proxy that can be used to study temperature changes from millions of years ago:",
                options: ["Tree rings from living trees in the Amazonian forest", "Isotopic ratios of oxygen elements in microscopic marine foraminifera", "Historical records of past flooding and draught events", "Satellite observations of the wavelengths of light emitted by glaciers"],
                correct: 1
            },
            {
                text: "What is the fundamental feedback on the temperature of all objects (including Earth) in the solar system:",
                options: ["Ice cover decreases at the poles when it gets warmer", "Increased water vapor leads to greater greenhouse warming", "Black-body radiation: when objects warm a little they radiate far more energy", "Increased cloud cover reflects more light back into space"],
                correct: 2
            },
            {
                text: "Extinction is:",
                options: ["a natural process", "proceeding more slowly now than at any other time", "something that occurs only rarely", "only caused by humans"],
                correct: 0
            },
            {
                text: "When applied to climate change, the precautionary principle states:",
                options: ["Negative feedbacks will always keep the planet's temperature from getting warm enough to harm human civilization", "If we are uncertain about the potentially catastrophic impacts of climate change, it is wise to curb our CO2 emissions", "Everything in the climate system is highly interconnected", "If there is any uncertainty about the science, it is better to put the interests of oil companies first"],
                correct: 1
            },
            {
                text: "What is an example of inductive reasoning in environmental science?",
                options: ["Using the theory of evolution to predict that species will adapt to climate change", "Observing that CO2 levels and temperature both increase, then concluding they are related", "Applying Newton's laws to explain atmospheric circulation", "Using established greenhouse theory to predict warming from increased CO2"],
                correct: 1
            },
            {
                text: "According to demographic transition theory, as countries develop economically they typically experience:",
                options: ["Increasing birth rates and increasing death rates", "Decreasing birth rates and decreasing death rates", "Increasing birth rates and decreasing death rates", "Constant birth rates and death rates"],
                correct: 1
            },
            {
                text: "The hydrologic cycle is driven primarily by:",
                options: ["Gravitational forces", "Solar energy", "Geothermal energy", "Wind patterns"],
                correct: 1
            },
            {
                text: "In the rock cycle, sedimentary rocks are formed by:",
                options: ["Cooling of molten rock", "Metamorphism under heat and pressure", "Weathering, erosion, and deposition", "Volcanic activity"],
                correct: 2
            },
            {
                text: "What is the main difference between kinetic and potential energy?",
                options: ["Kinetic energy is stored, potential energy is in motion", "Potential energy is stored, kinetic energy is in motion", "They are the same thing", "Kinetic energy comes from the sun, potential energy from the earth"],
                correct: 1
            },
            {
                text: "Atmospheric circulation is primarily driven by:",
                options: ["Ocean currents", "Uneven heating of Earth's surface", "The magnetic field", "Plate tectonics"],
                correct: 1
            },
            {
                text: "Which of the following is an example of convergent evolution?",
                options: ["Different finch species on the Galapagos Islands", "Similar wing structures in birds and bats", "Wolves and dogs sharing a common ancestor", "Humans and chimpanzees having similar DNA"],
                correct: 1
            },
            {
                text: "Island biogeography theory predicts that larger islands will have:",
                options: ["Fewer species than smaller islands", "More species than smaller islands", "The same number of species as smaller islands", "Only endemic species"],
                correct: 1
            },
            {
                text: "Milankovitch cycles refer to:",
                options: ["Daily temperature variations", "Seasonal weather patterns", "Long-term changes in Earth's orbit affecting climate", "Monthly tidal cycles"],
                correct: 2
            },
            {
                text: "Solar forcing refers to:",
                options: ["The greenhouse effect", "Changes in solar energy output affecting Earth's climate", "Photosynthesis", "Solar panel efficiency"],
                correct: 1
            },
            {
                text: "Which energy source is considered renewable?",
                options: ["Coal", "Natural gas", "Nuclear", "Wind"],
                correct: 3
            },
            {
                text: "Hydraulic fracturing (fracking) is primarily used to extract:",
                options: ["Coal", "Shale gas and oil", "Solar energy", "Geothermal energy"],
                correct: 1
            },
            {
                text: "The main concern with genetically modified foods according to critics is:",
                options: ["They taste different", "Potential unknown health effects", "They are more expensive", "They grow too slowly"],
                correct: 1
            },
            {
                text: "Aquaculture refers to:",
                options: ["Water conservation techniques", "Fish and seafood farming", "Water treatment processes", "Ocean wave energy"],
                correct: 1
            },
            {
                text: "What does BOD stand for in water quality assessment?",
                options: ["Biochemical Oxygen Demand", "Biological Oxygen Depletion", "Basic Oxygen Distribution", "Bacterial Oxygen Deficit"],
                correct: 0
            },
            {
                text: "Wetlands are important because they:",
                options: ["Filter pollutants from water", "Provide habitat for wildlife", "Help control flooding", "All of the above"],
                correct: 3
            },
            {
                text: "An externality in environmental economics is:",
                options: ["A cost paid by the company", "A cost or benefit affecting parties not directly involved in a transaction", "A government regulation", "An international trade agreement"],
                correct: 1
            },
            {
                text: "The tragedy of the commons occurs when:",
                options: ["Government controls all resources", "Individual rational behavior leads to collective irrationality", "Companies cooperate too much", "Resources are privately owned"],
                correct: 1
            },
            {
                text: "Risk-benefit analysis in environmental policy involves:",
                options: ["Only considering economic costs", "Weighing potential harms against potential benefits", "Ignoring scientific uncertainty", "Focusing only on short-term effects"],
                correct: 1
            },
            {
                text: "Ocean waste is primarily problematic because:",
                options: ["It makes the water look dirty", "Plastic pollution harms marine life and ecosystems", "It reduces fish populations for commercial fishing", "It affects ocean temperature"],
                correct: 1
            },
            {
                text: "The most abundant greenhouse gas in a humid atmosphere is:",
                options: ["Carbon dioxide", "Methane", "Water vapor", "Nitrous oxide"],
                correct: 2
            },
            {
                text: "Primary succession occurs:",
                options: ["After a forest fire", "After agricultural abandonment", "On newly formed volcanic rock", "In established ecosystems"],
                correct: 2
            },
            {
                text: "The main purpose of environmental impact assessment is to:",
                options: ["Increase project costs", "Evaluate potential environmental effects before development", "Delay construction projects", "Satisfy legal requirements only"],
                correct: 1
            },
            {
                text: "An explanation for a natural phenomenon that relates and explains many observations and is supported by a great deal of evidence is called a:",
                options: ["hypothesis", "controlled experiment", "technology", "theory", "fact"],
                correct: 3
            },
            {
                text: "Identify the source of the highest albedo:",
                options: ["fresh snow", "the Earth", "a pine forest", "a grass covered meadow", "dark rock"],
                correct: 0
            },
            {
                text: "When old-growth forests are harvested it may take hundreds of years for the forest to restore itself. This period is known as:",
                options: ["population collapse", "population overshoot", "exponential decline", "lag time", "ecosystem interval"],
                correct: 3
            },
            {
                text: "Which of the following statements is true about Northern Hemisphere Summer?",
                options: ["The Earth is closer to the sun", "The northern hemisphere is tilted towards the sun", "Light strikes the northern hemisphere at a more oblique angle than in the NH winter", "More light reaches the Earth"],
                correct: 1
            },
            {
                text: "The above syllogism 'A straight line is the shortest distance between two points. The line from A to B is the shortest distance between points A and B. Therefore, the line from A to B is a straight line' is an example of:",
                options: ["a scientific proof", "a hypothesis", "inductive reasoning", "deductive reasoning", "a scientific fact"],
                correct: 3
            },
            {
                text: "The rock cycle:",
                options: ["consists of numerous processes that produce rocks and soils", "depends on the tectonic and hydrologic cycle", "is not cyclic, but instead occurs in a one-directional course", "all of the above", "a and b only"],
                correct: 4
            },
            {
                text: "Mathematical models such as global circulation models (GCMs) are used to:",
                options: ["set up instrumentation stations in critical geographic locations", "make predictions of atmospheric changes on a global scale", "monitor atmospheric carbon dioxide concentrations", "calculate the rates of transfer of infrared radiation (IR) between the sun and the Earth", "measure radioactive particles in the atmosphere"],
                correct: 1
            },
            {
                text: "Scientists have adopted the Scientific Method as their standard procedure for answering questions about natural phenomena. They have relied on this technique because:",
                options: ["observations should only be done in a laboratory", "when using the Scientific Method, it is not necessary to conduct controlled experiments", "following a standardized procedure allows a scientist to compare his/her data with the results of other scientists", "the Scientific Method allows scientists to determine what their results will be before actually doing any experiments", "the results will always be useful quantitative data"],
                correct: 2
            },
            {
                text: "What type of energy is visible light?",
                options: ["Nuclear energy", "Electromagnetic energy", "Potential Energy", "Heat Energy", "Chemical Energy"],
                correct: 1
            },
            {
                text: "Hurricanes are fueled by:",
                options: ["Hot, moist air", "Cold, moist air", "Hot, dry air", "Cold, dry air"],
                correct: 0
            },
            {
                text: "What ultimately drives atmospheric circulation?",
                options: ["Differential heating of the Earth's surface that leads to areas of hot rising and cold cooling air", "An energy imbalance with greater energy near the polar regions", "The motion of the Earth", "The wind-driven circulation of the oceans"],
                correct: 0
            },
            {
                text: "The number of species in a given habitat is affected by which of the following?",
                options: ["latitude", "elevation", "topography", "severity of the environment", "all of the above"],
                correct: 4
            },
            {
                text: "If 10 kg of CO2 are added to the atmosphere and 1 kg of methane is added to the atmosphere, what can we say about the relative impact of each on climate change over a 10 year time horizon and over a 1000 year time horizon?",
                options: ["CO2 will have a greater impact on the 10 year time horizon and on the 1000 year time horizon", "Methane will have a greater impact on the 10 year time horizon and the 1000 year time horizon", "CO2 will have a greater impact on the 10 year time horizon, but methane will have a greater impact on the 1000 year time horizon", "Methane will have a greater impact on the 10 year time horizon, but CO2 will have a greater impact on the 1000 year time horizon", "We need more information about the molecules' behavior in the atmosphere to determine which will have a greater impact"],
                correct: 3
            },
            {
                text: "Simply stated, environmental unity means:",
                options: ["change in ecosystems is initiated in unison", "all changes in the natural environment are of equal impact", "many aspects of the natural environment are closely linked such that changes in one part of a system affect other parts of the system", "harmony of the natural environment can be achieved by making changes according to majority preferences", "secondary and tertiary effects of change within a system are negligible"],
                correct: 2
            },
            {
                text: "The following are all greenhouse gases that have increased in the troposphere due to human actions except:",
                options: ["Carbon dioxide", "Nitrogen", "Methane", "Ozone"],
                correct: 1
            },
            {
                text: "Two basic kinds of processes must occur in an ecosystem:",
                options: ["a cycling of chemical elements and a flow of energy", "the finding of mates and reproduction", "predator and prey", "producing and consuming food from inorganic compounds", "autotrophy and photosynthesis"],
                correct: 0
            },
            {
                text: "Biologically speaking, where a species lives is its ___, but what it does for a living is its ___:",
                options: ["ecological niche / habitat", "habitat / ecological niche", "residence / evolution", "evolution / diversity", "diversity / evolution"],
                correct: 1
            },
            {
                text: "What pieces of evidence tell us that CO2 increasing in the atmosphere is the result of burning fossil fuels:",
                options: ["Trends of carbon dioxide increase in the atmosphere closely match trends of fossil fuel burning", "The historical record shows that times with higher CO2 were typically warmer", "Radioactive 14C concentrations of atmospheric CO2 show a fossil fuel signature", "All of the above", "A and C"],
                correct: 4
            },
            {
                text: "The moratorium on commercial whaling:",
                options: ["went into effect in 1924", "has allowed many populations of whales to recover", "was described in the novel Moby Dick", "has been expanded to include sea lion and otters", "has led to the extinction of 12 whale species"],
                correct: 1
            },
            {
                text: "Which of the following is NOT an approach used by scientists to estimate the climate sensitivity (the total impact of all positive and negative feedbacks) to radiative forcing by carbon dioxide?",
                options: ["Global circulation models that incorporate many climate feedbacks", "Measurements of past climate temperatures and carbon dioxide determined from ice cores", "Temperature changes that result from short-term perturbations of the climate system after volcanic eruptions", "Measuring the isotopic signature of modern carbon dioxide"],
                correct: 3
            },
            {
                text: "Which of the following is NOT a key property of a population?",
                options: ["birth rates", "death rates", "growth rates", "maximum lifetime", "age structure"],
                correct: 3
            },
            {
                text: "The simplest and least controversial means of slowing population growth is:",
                options: ["abortion", "birth control", "delaying first childbearing", "no sexual activity before marriage", "sterilization"],
                correct: 2
            },
            {
                text: "The tendency for organisms, which possess favorable adaptations to a particular environment, to survive and leave descendants that form a larger proportion of the next generation is termed:",
                options: ["symbiosis", "philanthropy", "ecological principle", "natural selection", "altruism"],
                correct: 3
            },
            {
                text: "Blackbody radiation theory suggests that if any planet heats up it will emit more energy from itself and thus decreasing future heat increase, is this:",
                options: ["A negative feedback", "A positive feedback", "Not a feedback"],
                correct: 0
            },
            {
                text: "Which of the following is not a key theme of environmental science?",
                options: ["Human population growth", "A global perspective", "Ecosystem nutrient cycling", "An urbanizing world", "Science & Values"],
                correct: 2
            },
            {
                text: "When an animal digests food and then starts running they are:",
                options: ["Converting heat energy to potential energy", "Converting chemical energy to kinetic energy", "Converting heat energy to kinetic energy", "Converting chemical energy to potential energy", "Converting electromagnetic energy to heat energy"],
                correct: 1
            },
            {
                text: "Which of the following is NOT a suitable reason for valuing biodiversity?",
                options: ["products produced by species (i.e., honey by bees) are of direct value to people", "the belief that species have a right to exist", "theological beliefs", "the belief that nature is beautiful", "all of the above are valid reasons for valuing biodiversity"],
                correct: 4
            },
            {
                text: "Which of the following statements is true about oceanic circulation?",
                options: ["It is driven by sinking freshwater", "It transports heat from the poles to the equator", "It transports heat from the equator to the poles", "It is driven by whales' tails"],
                correct: 2
            },
            {
                text: "What ecological change could lead to the spread of the Zika virus into Florida?",
                options: ["Changes in phenology", "Range expansion", "Niche differentiation", "Predation", "Mutualism"],
                correct: 1
            },
            {
                text: "Zooxanthellae are tiny algae that live inside coral polyps and provide energy through photosynthesis. This is an example of:",
                options: ["Niche differentiation", "Competition", "Predation", "Mutualism", "Parasitism"],
                correct: 3
            },
            {
                text: "Which of the following is true?",
                options: ["Species on Earth today are but a fraction of all species that ever lived", "The number of species existing at one time has decreased throughout history", "Extinctions of past species have happened gradually and on a small scale", "Most organisms present in Earth's prehistory were more complex than modern organisms", "Bacteria represent a newer form of life, not present during the early prehistory of Earth"],
                correct: 0
            },
            {
                text: "Which statement is not true about Milankovitch cycles?",
                options: ["Milankovitch cycles are changes in the Earth's rotation and orbit", "Milankovitch cycles may be responsible for glacial and interglacial climate variability", "Milankovitch cycles have periodicity of 41,000 or 100,000 years", "Milankovitch cycles are driven by dense, sinking seawater"],
                correct: 3
            },
            {
                text: "The functional role of a species in its community is its:",
                options: ["habitat", "place in the food chain", "selection", "niche", "distribution"],
                correct: 3
            },
            {
                text: "Plate tectonics was elevated to the status of a scientific theory because:",
                options: ["because it was a guess made by scientists that needs to be tested", "it could explain a diverse set of phenomena including fossil patterns, earthquakes, mountain formation, and the shape of the continents", "scientific theories, like the theory of gravity, are not agreed upon by scientists", "plate tectonics explains why species go extinct", "plate tectonics was proposed by an influential scientist"],
                correct: 1
            },
            {
                text: "Zebra mussels are an invasive species in many rivers and lakes in the United States. They engage in exploitation competition with native zooplankton. Zooplankton populations in Lake Erie and the Hudson River have declined by up to 70% since the arrival of zebra mussels because:",
                options: ["zebra mussels prey exclusively on zooplankton", "zebra mussels carry a parasite that kills zooplankton", "zebra mussels feed on phytoplankton, which zooplankton need as a food source", "waste from zebra mussels promotes bacterial growth that kills zooplankton"],
                correct: 2
            }
        ];
        
        let currentQuestion = 0;
        let selectedOption = -1;
        let questionResults = []; // Track results for each question
        let currentRound = 1;
        let isReviewMode = false;
        let reviewQuestions = [];
        let shuffledQuestions = []; // Store shuffled version of questions
        let stats = {
            'not-learned': 0,
            'still-learning': 0,
            'mastered': 0
        };
        
        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            const shuffled = [...array]; // Create a copy
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }
        
        // Shuffle answer options and track correct answer
        function shuffleQuestionOptions(question) {
            const originalOptions = [...question.options];
            const correctAnswer = originalOptions[question.correct];
            
            // Create array of indices and shuffle them
            const indices = Array.from({length: originalOptions.length}, (_, i) => i);
            const shuffledIndices = shuffleArray(indices);
            
            // Create shuffled options array
            const shuffledOptions = shuffledIndices.map(i => originalOptions[i]);
            
            // Find new position of correct answer
            const newCorrectIndex = shuffledOptions.indexOf(correctAnswer);
            
            return {
                ...question,
                options: shuffledOptions,
                correct: newCorrectIndex,
                originalOptions: originalOptions,
                originalCorrect: question.correct
            };
        }
        
        function displayQuestion() {
            if (currentQuestion >= getCurrentQuestionSet().length) {
                if (isReviewMode || getUnmasteredQuestions().length === 0) {
                    showCompletion();
                } else {
                    startReviewRound();
                }
                return;
            }
            
            const questionSet = getCurrentQuestionSet();
            const originalQuestion = questionSet[currentQuestion];
            
            // Shuffle the answer options for this question
            const question = shuffleQuestionOptions(originalQuestion);
            
            const totalQuestions = questionSet.length;
            
            document.getElementById('questionNumber').textContent = `Question ${currentQuestion + 1} of ${totalQuestions}`;
            document.getElementById('questionText').textContent = question.text;
            
            const optionsList = document.getElementById('optionsList');
            optionsList.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const li = document.createElement('li');
                li.className = 'option';
                li.textContent = `${String.fromCharCode(65 + index)}. ${option}`;
                li.onclick = () => selectOption(index, li);
                optionsList.appendChild(li);
            });
            
            // Store the shuffled question for answer checking
            window.currentShuffledQuestion = question;
            
            // Reset UI
            document.getElementById('resultMessage').classList.add('hidden');
            document.getElementById('submitBtn').classList.remove('hidden');
            document.getElementById('nextBtn').classList.add('hidden');
            document.getElementById('submitBtn').disabled = true;
            selectedOption = -1;
        }
        
        function getCurrentQuestionSet() {
            return isReviewMode ? reviewQuestions : shuffledQuestions;
        }
        
        function getUnmasteredQuestions() {
            return shuffledQuestions.filter((question, shuffledIndex) => {
                // Find original index of this question
                const originalIndex = questions.findIndex(q => q.text === question.text);
                const result = questionResults[originalIndex];
                return !result || result.status !== 'mastered';
            });
        }
        
        function startReviewRound() {
            reviewQuestions = shuffleArray(getUnmasteredQuestions()); // Shuffle review questions too
            if (reviewQuestions.length === 0) {
                showCompletion();
                return;
            }
            
            isReviewMode = true;
            currentQuestion = 0;
            currentRound++;
            
            const roundIndicator = document.getElementById('roundIndicator');
            roundIndicator.textContent = `Round ${currentRound} - Review (${reviewQuestions.length} questions to master)`;
            roundIndicator.classList.add('review-mode');
            
            displayQuestion();
        }
        
        function selectOption(index, element) {
            document.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });
            element.classList.add('selected');
            selectedOption = index;
            document.getElementById('submitBtn').disabled = false;
        }
        
        function submitAnswer() {
            if (selectedOption === -1) return;
            
            const question = window.currentShuffledQuestion; // Use the shuffled version
            const isCorrect = selectedOption === question.correct;
            const resultMessage = document.getElementById('resultMessage');
            
            // Find the original question index using the original question text
            const originalIndex = questions.findIndex(q => q.text === question.text);
            
            // Color the options
            const options = document.querySelectorAll('.option');
            options.forEach((option, index) => {
                if (index === question.correct) {
                    option.classList.add('correct');
                } else if (index === selectedOption && !isCorrect) {
                    option.classList.add('incorrect');
                }
                option.onclick = null; // Disable clicking
            });
            
            // Determine status and update results
            let status;
            if (isCorrect) {
                status = 'mastered';
                resultMessage.textContent = "✅ Correct! This question is MASTERED";
                resultMessage.className = "result-message result-correct";
            } else {
                // Check if this question was previously attempted
                const previousResult = questionResults[originalIndex];
                if (previousResult && previousResult.status === 'still-learning') {
                    status = 'not-learned';
                    resultMessage.textContent = "❌ Incorrect again. This question is NOT LEARNED";
                } else {
                    status = 'still-learning';
                    resultMessage.textContent = "⚠️ Incorrect. This question is STILL LEARNING";
                }
                resultMessage.className = "result-message result-incorrect";
            }
            
            // Update question results
            if (!questionResults[originalIndex] || questionResults[originalIndex].status !== 'mastered') {
                // Remove old status from stats if it exists
                if (questionResults[originalIndex]) {
                    stats[questionResults[originalIndex].status]--;
                }
                
                // Add new status
                questionResults[originalIndex] = { status: status, attempts: (questionResults[originalIndex]?.attempts || 0) + 1 };
                stats[status]++;
            }
            
            resultMessage.classList.remove('hidden');
            document.getElementById('submitBtn').classList.add('hidden');
            document.getElementById('nextBtn').classList.remove('hidden');
            
            updateStats();
            updateProgress();
        }
        
        function nextQuestion() {
            currentQuestion++;
            displayQuestion();
        }
        
        function updateStats() {
            document.getElementById('notLearnedCount').textContent = stats['not-learned'];
            document.getElementById('stillLearningCount').textContent = stats['still-learning'];
            document.getElementById('masteredCount').textContent = stats['mastered'];
        }
        
        function updateProgress() {
            const total = Object.values(stats).reduce((a, b) => a + b, 0);
            const questionSet = getCurrentQuestionSet();
            const percentage = (total / questions.length) * 100; // Always use total questions for overall progress
            document.getElementById('progressFill').style.width = percentage + '%';
        }
        
        function showCompletion() {
            const total = questions.length;
            const percentage = Math.round((stats['mastered'] / total) * 100);
            
            document.getElementById('questionContainer').classList.add('hidden');
            document.getElementById('completionMessage').classList.remove('hidden');
            
            document.getElementById('finalMastered').textContent = stats['mastered'];
            document.getElementById('finalStillLearning').textContent = stats['still-learning'];
            document.getElementById('finalNotLearned').textContent = stats['not-learned'];
            document.getElementById('finalPercentage').textContent = percentage;
            
            // Update completion message for multiple rounds
            const completionTitle = document.querySelector('#completionMessage h2');
            if (currentRound > 1) {
                completionTitle.textContent = `🎉 All Questions Mastered After ${currentRound} Rounds!`;
            } else {
                completionTitle.textContent = '🎉 Perfect Score - All Questions Mastered!';
            }
        }
        
        function resetQuiz() {
            currentQuestion = 0;
            selectedOption = -1;
            questionResults = [];
            currentRound = 1;
            isReviewMode = false;
            reviewQuestions = [];
            shuffledQuestions = shuffleArray(questions); // Create new shuffle on reset
            stats = {'not-learned': 0, 'still-learning': 0, 'mastered': 0};
            
            const roundIndicator = document.getElementById('roundIndicator');
            roundIndicator.textContent = 'Round 1 - Initial Learning';
            roundIndicator.classList.remove('review-mode');
            
            updateStats();
            updateProgress();
            document.getElementById('questionContainer').classList.remove('hidden');
            document.getElementById('completionMessage').classList.add('hidden');
            displayQuestion();
        }
        
        // Initialize the quiz
        function initializeQuiz() {
            shuffledQuestions = shuffleArray(questions); // Shuffle questions on first load
            displayQuestion();
        }
        
        // Initialize when page loads
        initializeQuiz();
    </script>
</body>
</html>
